<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="image/favicon.ico">

    <title>RISK: Legacy Roller</title>

    <!-- Bootstrap core JavaScript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="https://maxcdn.bootstrapcdn.com/js/ie10-viewport-bug-workaround.js"></script>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">


    <!-- Bootstrap Toggle; http://www.bootstraptoggle.com/ -->
    <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.0/css/bootstrap-toggle.min.css" rel="stylesheet">
    <script src="https://gitcdn.github.io/bootstrap-toggle/2.2.0/js/bootstrap-toggle.min.js"></script>

    <!-- Bootstrap Touchspin; http://www.virtuosoft.eu/code/bootstrap-touchspin/ [Apache] -->
    <link href="touchspin/touchspin.min.css" rel="stylesheet">
    <script src="touchspin/touchspin.min.js"></script>

    <!-- Custom styles for this template -->
    <link href="css/style.css" rel="stylesheet">
    <script src="js/risk-legacy-roller.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>

<!-- Main jumbotron for a primary marketing message or call to action -->
<div class="jumbotron">
    <div class="container">
        <h1>RISK Legacy Roller: Alpha</h1>
        <div>This doesn't work yet...</div>
    </div>
</div>

<div class="container">
    <form class="form-horizontal">
        <div class="row">
            <div class="col-md-5">
                <h2>Attacker</h2>


                <div class="form-group">
                    <label for="attacker-armies" class="col-sm-4 control-label">Armies</label>

                    <div class="col-sm-8">
                        <input id="attacker-armies" class="form-control" type="text" value="0"/>
                    </div>

                    <script>
                        $("input[id='attacker-armies']").TouchSpin();
                    </script>
                </div>

                <div class="form-group">
                    <label class="col-sm-4 control-label">Power</label>

                    <div class="col-sm-8 btn-group" data-toggle="buttons">
                        <label class="btn btn-primary active">
                            <input type="radio" name="attacker-power" value="" autocomplete="off" checked> None
                        </label>
                        <label class="btn btn-primary">
                            <input type="radio" name="attacker-power" value="firststrike" autocomplete="off"> First
                            Strike
                        </label>
                        <label class="btn btn-primary">
                            <input type="radio" name="attacker-power" value="threes" autocomplete="off"> Threes
                        </label>
                    </div>
                </div>

            </div>

            <div class="col-md-2"></div>

            <div class="col-md-5">
                <h2>Defender</h2>

                <div class="form-group">
                    <label for="defender-armies" class="col-sm-4 control-label">Armies</label>

                    <div class="col-sm-8">
                        <input id="defender-armies" class="form-control" type="text" value="0"/>
                    </div>

                    <script>
                        $("input[id='defender-armies']").TouchSpin();
                    </script>
                </div>

                <div class="form-group">
                    <label class="col-sm-4 control-label">Power</label>

                    <div class="col-sm-8 btn-group" data-toggle="buttons">
                        <label class="btn btn-primary active">
                            <input type="radio" name="defender-power" value="" autocomplete="off" checked> None
                        </label>
                        <label class="btn btn-primary">
                            <input type="radio" name="defender-power" value="fortified" autocomplete="off"> Fortified
                            Base
                        </label>
                        <label class="btn btn-primary">
                            <input type="radio" name="defender-power" value="sixes" autocomplete="off"> Sixes
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-4 control-label">Scars</label>

                    <div class="col-sm-8 btn-group" data-toggle="buttons">
                        <label class="btn btn-primary active">
                            <input type="radio" name="defender-scars" value="" autocomplete="off" checked> None
                        </label>
                        <label class="btn btn-primary">
                            <input type="radio" name="defender-scars" value="bunker" autocomplete="off"> Bunker
                        </label>
                        <label class="btn btn-primary">
                            <input type="radio" name="defender-scars" value="ammoshortage" autocomplete="off"> Ammo
                            Shortage
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label for="defender-fortification" class="col-sm-4 control-label">Fortification</label>

                    <div class="col-sm-8">
                        <input id="defender-fortification" class="form-control" type="text" value="0"/>
                    </div>

                    <script>
                        $("input[id='defender-fortification']").TouchSpin({
                            min: 0,
                            max: 10
                        });
                    </script>
                </div>


            </div>

        </div>

        <div class="row">
            <div class="col-md-5"><!-- Attacker -->

                <div class="form-group">
                    <label for="attacker-highest-bonus" class="col-sm-4 control-label">Highest Bonus</label>

                    <div class="col-sm-8">
                        <input id="attacker-highest-bonus" class="form-control" type="text" value="0"/>
                    </div>
                    <script>
                        $("input[id='attacker-highest-bonus']").TouchSpin();
                    </script>
                </div>

                <div class="form-group">
                    <label for="attacker-highest-bonus" class="col-sm-4 control-label">Lowest Bonus</label>

                    <div class="col-sm-8">
                        <input id="attacker-lowest-bonus" class="form-control" type="text" value="0"/>
                    </div>
                    <script>
                        $("input[id='attacker-lowest-bonus']").TouchSpin();
                    </script>
                </div>

            </div>
            <div class="col-md-2"><!-- Middle -->
            </div>
            <div class="col-md-5"><!-- Defender -->

                <div class="form-group">
                    <label for="defender-highest-bonus" class="col-sm-4 control-label">Highest Bonus</label>

                    <div class="col-sm-8">
                        <input id="defender-highest-bonus" class="form-control" type="text" value="0"/>
                    </div>
                    <script>
                        $("input[id='defender-highest-bonus']").TouchSpin();
                    </script>
                </div>

                <div class="form-group">
                    <label for="defender-highest-bonus" class="col-sm-4 control-label">Lowest Bonus</label>

                    <div class="col-sm-8">
                        <input id="defender-lowest-bonus" class="form-control" type="text" value="0"/>
                    </div>
                    <script>
                        $("input[id='defender-lowest-bonus']").TouchSpin();
                    </script>
                </div>

            </div>
        </div>
        <div class="row">
            <div class="col-md-5"><!-- Attacker -->
                <div class="row">
                    <div id="attacker-die-0" class="col-md-4 text-center">
                        <div>
                            <img id="attacker-die-0-rolled" src="image/dieWhite_border0.png"/>
                        </div>
                        <div class="missle-toggle">
                            <input id="attacker-die-0-missle-toggle" type="checkbox" data-toggle="toggle"
                                   data-on="Missle" data-off="No Missle"/>
                        </div>
                        <div id="attacker-die-0-bonus"></div>
                        <div><span class="glyphicon glyphicon-arrow-down" aria-hidden="true"></span></div>
                        <div id="attacker-die-0-final">
                            <img id="attacker-die-0-value" src="image/dieWhite_border0.png"/>
                        </div>
                        <div>
                            <span id="attacker-die-0-indicator"></span>
                        </div>
                    </div>
                    <div id="attacker-die-1" class="col-md-4 text-center">
                        <div>
                            <img id="attacker-die-1-rolled" src="image/dieWhite_border0.png"/>
                        </div>
                        <div class="missle-toggle">
                            <input id="attacker-die-1-missle-toggle" type="checkbox" data-toggle="toggle"
                                   data-on="Missle" data-off="No Missle"/>
                        </div>
                        <div id="attacker-die-1-bonus"></div>
                        <div><span class="glyphicon glyphicon-arrow-down" aria-hidden="true"></span></div>
                        <div id="attacker-die-1-final">
                            <img id="attacker-die-1-value" src="image/dieWhite_border0.png"/>
                        </div>
                        <div>
                            <span id="attacker-die-1-indicator"></span>
                        </div>
                    </div>
                    <div id="attacker-die-2" class="col-md-4 text-center">
                        <div>
                            <img id="attacker-die-2-rolled" src="image/dieWhite_border0.png"/>
                        </div>
                        <div class="missle-toggle">
                            <input id="attacker-die-2-missle-toggle" type="checkbox" data-toggle="toggle"
                                   data-on="Missle" data-off="No Missle"/>
                        </div>
                        <div id="attacker-die-2-bonus"></div>
                        <div><span class="glyphicon glyphicon-arrow-down" aria-hidden="true"></span></div>
                        <div id="attacker-die-2-final">
                            <img id="attacker-die-2-value" src="image/dieWhite_border0.png"/>
                        </div>
                        <div>
                            <span id="attacker-die-2-indicator"></span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-2">

                <p class="text-center">
                    <button id="attack" type="button" class="btn btn-primary btn-lg">Attack</button>
                </p>
                <script>
                    $("#attack").click(function () {
                        var attacking_armies = parseInt($('#attacker-armies').val());
                        var defending_armies = parseInt($('#defender-armies').val());
                        if (attacking_armies == 0 && defending_armies == 0) {
                            alert('Enter armies');
                        } else if (defending_armies == 0) {
                            alert('Defender defeated!');
                        } else if (attacking_armies == 0) {
                            alert('Attacker defeated!');
                        } else {
                            var battle = new Battle(
                                    new Territory(
                                            new Faction($('#attacker-power').val()),
                                            0,
                                            '',
                                            parseInt($('#attacker-armies').val())
                                    ),
                                    new Territory(
                                            new Faction($('#defender-power').val()),
                                            parseInt($('#defender-fortification').val()),
                                            $('#defender-scar').val(),
                                            parseInt($('#defender-armies').val())
                                    )
                            );
                            battle.attack(
                                    Math.min(3, attacking_armies - 1),
                                    Math.min(2, defending_armies)
                            );
                            var res = battle.resolve();
                            var attacker_loss = res[0];
                            var defender_loss = res[1];
                            var stop = res[2];

                            for (i = 0; i < battle.dice.length; i++) {
                                var die = battle.dice[i];
                                $('#' + die.side + '-die-' + die.index + '-rolled').attr('src', die.rolled_image());
                                $('#' + die.side + '-die-' + die.index + '-bonus').val((die.bonus >= 0 ? '+' : '-') + die.bonus);
                                $('#' + die.side + '-die-' + die.index + '-value').attr('src', die.value_image());
                                $('#' + die.side + '-die-' + die.index + '-indicator').attr('class', die.won == true ? 'glyphicon glyphicon-ok' : 'glyphicon glyphicon-remove');
                            }

                            $('#messages').append('<div class="alert alert-info" role="alert">Attackers lose '
                                    + attacker_loss + '; Defenders lose ' + defender_loss + '</div>');

                            if (battle.messages) {
                                for (var i = 0; i < battle.messages.length; i++) {
                                    $('#messages').append('<div class="alert alert-'
                                    + stop == true ? 'danger' : 'info' + '" role="alert">'
                                    + battle.messages[i] + '</div>');
                                }
                            }

                            $('#attacker-armies').val(battle.attacker.armies - attacker_loss);
                            $('#defender-armies').val(battle.defender.armies - defender_loss);
                            $('#defender-fortification').val(battle.defender.fortified);
                        }
                    });
                </script>

            </div>
            <div class="col-md-5"><!-- Defender -->
                <div class="row">
                    <div id="defender-die-0" class="col-md-6 text-center">
                        <div>
                            <img id="defender-die-0-rolled" src="image/dieRed_border0.png"/>
                        </div>
                        <div class="missle-toggle">
                            <input id="defender-die-0-missle-toggle" type="checkbox" data-toggle="toggle"
                                   data-on="Missle" data-off="No Missle"/>
                        </div>
                        <div id="defender-die-0-bonus"></div>
                        <div><span class="glyphicon glyphicon-arrow-down" aria-hidden="true"></span></div>
                        <div id="defender-die-0-final">
                            <img id="defender-die-0-value" src="image/dieRed_border0.png"/>
                        </div>
                        <div>
                            <span id="defender-die-0-indicator"></span>
                        </div>
                    </div>
                    <div id="defender-die-1" class="col-md-6 text-center">
                        <div>
                            <img id="defender-die-1-rolled" src="image/dieRed_border0.png"/>
                        </div>
                        <div class="missle-toggle">
                            <input id="defender-die-1-missle-toggle" type="checkbox" data-toggle="toggle"
                                   data-on="Missle" data-off="No Missle"/>
                        </div>
                        <div id="defender-die-1-bonus"></div>
                        <div><span class="glyphicon glyphicon-arrow-down" aria-hidden="true"></span></div>
                        <div id="defender-die-1-final">
                            <img id="defender-die-1-value" src="image/dieRed_border0.png"/>
                        </div>
                        <div>
                            <span id="defender-die-1-indicator"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="messages">
        </div>

    </form>
</div>
<!-- /container -->
</body>
</html>
